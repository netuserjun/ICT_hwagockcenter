스토리지 연결방식
DAS 
케이블로 직접 연결
NAS 
스토리지를 네트워크로 제공
파일시스템까지 만들어서 제공함
SAN
스토리지를 네트워크로 제공
사용자가 파티셔닝과 FS, 마운트까지 직접 설정


일반적인 서비스 구성 순서
패키지 설치
yum(centos) , atp(ubuntu)
서비스 설정(설정파일, 스토리지, 사용자, 디렉토리...)
서비스 활성화
systemctl(centos7버전이상) service,
방화벽, 네트워크 설정
firewall-cmd

https://twofootdog.tistory.com/27(인스턴스,vpc, 기타등등 싹다 삭제햇을때 참고)
NFS
Unix /Linux 계열에서 파일 공유시 사용하는 표준 프로토콜

서버에서 디렉토리를 공유하도록 설정
패키지 설치
yum -y install nfs-utils
공유 디렉토리 생성 및 준비(권한설정)
mkdir /nfs_share
vi /etc/exports
/nfs_share *(rw,sync,insecure)
insecure 안하면 포트1024 이하만 허가
공유 설정(/etc/exports)
공유디렉토리 : PATH
대상 : IP/DNS
옵션 : 읽기쓰기 rw/ro , 동기화방식 sync/async
보안방식 5가지
none : UID/GID 기준으로 권한설정, 모든 사용자가 nfsnobody로 접근, 거의 안씀
sys(기본) : UID/GID 기준으로 권한 설정, 각기 다른 UID 사용, 
krb5 : kerberos 기반 인증사용
krb5i : 무결성 보장 추가
krb5p : 모든 데이터를 암호화해서 주고받음
exportfs -r 로 갱신해야 적용

서비스 활성화
방화벽 설정(aws는 firewalld 자체가 없)
aws 보안그룹 nfs 규칙추가. ping 보내고싶으면 icmp 규칙추가. 위치무관
https://blog.munilive.com/posts/install-nfs-server-in-aws.html
클라이언트 마운트 설정
mount : 명령어 실행 시 연결
mount -o (rw,sync)
mount -t (파일타입지정)
/etc/fstab : 부팅할 때 자동으로 연결
autofs : 자동으로 연결/해제 해주는 방식
네트워크 사용을 줄여주는 역할
클라에서만 설정해주면 됨.
/etc/fstab로 설정한 값이 있으면 충돌남
패키지 autofs 설치
/etc/auto.master.d/이름.autofs : 마스터맵파일
디렉토리, 매핑파일 경로 기입
/etc/auto.이름 			: 매핑파일
마운트포인트이름, 옵션, 공유디렉토리 기입



SAMBA
	윈도우에서도 파일공유를 하고 싶을 때. 혹은 프린트 장치 등을 쓸 때.

서버 쪽 설정.
1. 패키지 설치 - 	samba, samba-client
2. 디렉토리 준비 ( 만들고 권한설정 )
3. 설정파일 - 	/etc/samba/smb.conf
4. 서비스 활성화 - 	smb, nmb
5. 방화벽 설정 - 	samba

[root@server ~]# yum -y install samba samba-client > /dev/null  
[root@server ~]# mkdir -p /shares/samba           
[root@server ~]# vim /etc/samba/smb.conf          
[root@server ~]# grep -A 5 sambashare /etc/samba/smb.conf
[sambashare]
	path = /shares/samba
#	valid user = user01,@wheel
#	write list = user01
#	browseable = no

[root@server ~]# systemctl enable --now smb nmb > /dev/null
Created symlink from /etc/systemd/system/multi-user.target.wants/smb.service to /usr/lib/systemd/system/smb.service.
Created symlink from /etc/systemd/system/multi-user.target.wants/nmb.service to /usr/lib/systemd/system/nmb.service.
[root@server ~]# firewall-cmd --add-service=samba


클라이언트 설정
1. 패키지 설치 - 	cifs-utils 
2. 마운트포인트 준비
3. 마운트	-	mount ,  /etc/fstab ,  autofs
		파일시스템 : cifs
		장치이름 : 	//Server-IP/NAME
		옵션 : 	username=XXX,password=XXX	-> 직접 사용자/PW 입력
			cifscredentials=FILE                 -> FILE에 사용자/PW 저장
		FILE
		username=XXX
		password=XXX
		domain=XXXX

